jQuery(document).ready(function(e){"use strict";var t=e("#add-new"),a=e("#add-new-name"),i=e("#ywccp_field_add_edit_form"),d=e("#ywccp_checkout_fields"),n=function(t,a,i,d,n){if(t.attr("data-row",d),t.attr("data-action",i),!n){var c=t.find("tr.remove_default");c.length&&c.remove()}t.find('select[name="field_type"]').on("change",function(){var a=t.find("tr[data-hide]"),i=e(this).val();a.length&&e.each(a,function(){var t=e(this).data("hide").split(",");e.inArray(i,t)>-1?e(this).hide():e(this).show()})}).trigger("change"),t.dialog({title:a,modal:!0,width:500,resizable:!1,autoOpen:!1,buttons:[{text:"Save",click:function(){e.edit_add_field(this)&&e(this).dialog("close")}}],close:function(e,a){t.dialog("destroy"),t.remove()}})},c=function(e){var t=d.data("prepend");return e=e.replace(" ","_"),""!=t&&-1===e.indexOf(t)&&(e=t+e),e};a.on("focus",function(){e(this).removeClass("required field-exists")}),t.on("click",function(){var e,t=a.val();if(""==t)return a.addClass("required"),!1;if(t=c(t),e=d.find('input.field_name[value="'+t+'"]'),e.length)return a.addClass("field-exists"),!1;var l=i.clone();n(l,ywccp_admin.popup_add_title,"add","",!0),l.find('input[name="field_name"]').val(t),l.dialog("open")}),e(document).on("click","button.edit_field",function(){var t=e(this).closest("tr"),a=t.data("row"),d=t.find('input[type="hidden"]'),c=i.clone();e.each(d,function(t,a){var i=e(a).data("name"),d=c.find('td *[name="'+i+'"]');if("checkbox"==d.attr("type")){var n=e(a).val();0==n?d.removeAttr("checked"):d.attr("checked","checked")}else d.val(e(a).val())}),n(c,ywccp_admin.popup_edit_title,"edit",a,t.hasClass("is_custom")),c.dialog("open")}),e.edit_add_field=function(t){var a,i,n=d.find("tbody tr"),l=e(t).data("action");if("edit"==l?(i=e(t).data("row"),a=n.filter('[data-row="'+i+'"]')):(a=n.filter(":not(.disabled-row)").last().clone(),i=n.size(),a.attr("data-row",i),a.addClass("is_custom")),e.each(a.find('input[type="hidden"]'),function(i,d){var n=e(d).data("name"),l=e(t).find('td *[name="'+n+'"]'),o="",r="";l.length&&("checkbox"==l.attr("type")?(o=l.is(":checked")?1:0,r=1==o?ywccp_admin.enabled:"-"):(o=l.val(),"field_name"==n&&(o=c(o)),r=o),e(d).val(o),a.find(".td_"+n).html(r))}),"add"==l&&(n.last().after(a),"undefined"!=typeof e.fn.tipTip)){var o={attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200};a.find(".tips").tipTip(o)}return!0},e(".check-column input").on("change",function(){var t=(e(this),e("td.td_select input"));e(this).is(":checked")?t.attr("checked","checked"):t.removeAttr("checked")}),e(document).on("click","button.enable_field",function(){var t,a=e(this),i=a.closest("tr"),d=i.find('input[data-name="field_enabled"]');i.toggleClass("disabled-row"),d.length&&d.val(i.hasClass("disabled-row")?"0":"1"),t=a.html(),a.html(a.data("label")),a.data("label",t)});e(document).on("click","button.remove_field",function(){var t=e(this),a=t.closest("tr");a.hasClass("is_custom")&&a.fadeOut(400,function(){a.addClass("disabled-row").hide(),a.find('input[data-name="field_deleted"]').val("yes")})});var l=e(".ywccp_multiselect_admin"),o=e(".ywccp_datepicker_admin");l&&e.each(l,function(){var t=e(this),a=t.data("value").split(", ");t.after('<input type="hidden" name="'+t.attr("name")+'" value>'),t.on("change",function(){var t=e(this).val();t=t?t.join(", "):"",e(this).next().val(t)}),t.val(a).trigger("change"),"undefined"!=typeof e.fn.select2&&t.select2()}),"undefined"!=typeof e.fn.datepicker&&o&&e.each(o,function(){e(this).datepicker()})});